# –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Ñ–æ—Ç–æ-–¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

## –®–∞–≥ 1: –î–æ–±–∞–≤–∏—Ç—å PhotoProvider –≤ layout.js

–û—Ç–∫—Ä–æ–π—Ç–µ —Ñ–∞–π–ª `src/app/layout.js` –∏ –≤–Ω–µ—Å–∏—Ç–µ —Å–ª–µ–¥—É—é—â–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è:

### 1.1 –î–æ–±–∞–≤—å—Ç–µ –∏–º–ø–æ—Ä—Ç (–ø–æ—Å–ª–µ —Å—Ç—Ä–æ–∫–∏ 8):
```javascript
import { ThemeProvider } from "../context/ThemeContext";
import { PhotoProvider } from "../context/PhotoContext";  // ‚Üê –î–û–ë–ê–í–ò–¢–¨ –≠–¢–£ –°–¢–†–û–ö–£
import { BackupProvider } from "../context/BackupContext";
```

### 1.2 –û–±–µ—Ä–Ω–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –≤ PhotoProvider (—Å—Ç—Ä–æ–∫–∏ 47-48):
–ù–∞–π–¥–∏—Ç–µ —Å—Ç—Ä–æ–∫—É —Å `<ThemeProvider>` –∏ –¥–æ–±–∞–≤—å—Ç–µ `<PhotoProvider>` —Å—Ä–∞–∑—É –ø–æ—Å–ª–µ –Ω–µ—ë:

```javascript
<ThemeProvider>
    <PhotoProvider>  {/* ‚Üê –î–û–ë–ê–í–ò–¢–¨ */}
        <SyncProvider>
```

### 1.3 –ó–∞–∫—Ä–æ–π—Ç–µ PhotoProvider (—Å—Ç—Ä–æ–∫–∏ 70-71):
–ù–∞–π–¥–∏—Ç–µ –∑–∞–∫—Ä—ã–≤–∞—é—â–∏–µ —Ç–µ–≥–∏ –∏ –¥–æ–±–∞–≤—å—Ç–µ –∑–∞–∫—Ä—ã—Ç–∏–µ PhotoProvider:

```javascript
        </SyncProvider>
    </PhotoProvider>  {/* ‚Üê –î–û–ë–ê–í–ò–¢–¨ */}
</ThemeProvider>
```

---

## –®–∞–≥ 2: –ü—Ä–∏–º–µ–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é –ë–î

### –í–∞—Ä–∏–∞–Ω—Ç A: –ß–µ—Ä–µ–∑ Supabase Dashboard (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
1. –û—Ç–∫—Ä–æ–π—Ç–µ Supabase Dashboard: https://supabase.com/dashboard
2. –í—ã–±–µ—Ä–∏—Ç–µ –≤–∞—à –ø—Ä–æ–µ–∫—Ç
3. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ **SQL Editor**
4. –û—Ç–∫—Ä–æ–π—Ç–µ —Ñ–∞–π–ª `supabase/migrations/project_photos.sql`
5. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –≤–µ—Å—å SQL –∫–æ–¥
6. –í—Å—Ç–∞–≤—å—Ç–µ –≤ SQL Editor –∏ –Ω–∞–∂–º–∏—Ç–µ **Run**

### –í–∞—Ä–∏–∞–Ω—Ç B: –ß–µ—Ä–µ–∑ CLI
```bash
# –ï—Å–ª–∏ —É –≤–∞—Å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω Supabase CLI
supabase db push

# –ò–ª–∏ –ø—Ä–∏–º–µ–Ω–∏—Ç–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—É—é –º–∏–≥—Ä–∞—Ü–∏—é
supabase migration up
```

---

## –®–∞–≥ 3: –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å –≤ SummaryStep.js (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

–ï—Å–ª–∏ —Ö–æ—Ç–∏—Ç–µ –¥–æ–±–∞–≤–∏—Ç—å –≤–∫–ª–∞–¥–∫—É "–§–æ—Ç–æ" –≤ —ç–∫—Ä–∞–Ω —Å–º–µ—Ç—ã:

### 3.1 –î–æ–±–∞–≤—å—Ç–µ –∏–º–ø–æ—Ä—Ç –≤ –Ω–∞—á–∞–ª–æ —Ñ–∞–π–ª–∞:
```javascript
import PhotoUploader from '../photos/PhotoUploader';
import PhotoGallery from '../photos/PhotoGallery';
import { usePhotos } from '@/context/PhotoContext';
```

### 3.2 –î–æ–±–∞–≤—å—Ç–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –º–æ–¥–∞–ª–∫–æ–π:
```javascript
const [showPhotoUploader, setShowPhotoUploader] = useState(false);
```

### 3.3 –î–æ–±–∞–≤—å—Ç–µ –∫–Ω–æ–ø–∫—É "–î–æ–±–∞–≤–∏—Ç—å —Ñ–æ—Ç–æ" –≤ JSX:
```javascript
<button
    onClick={() => setShowPhotoUploader(true)}
    className="apple-button"
>
    üì∏ –î–æ–±–∞–≤–∏—Ç—å —Ñ–æ—Ç–æ
</button>
```

### 3.4 –î–æ–±–∞–≤—å—Ç–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –≥–∞–ª–µ—Ä–µ–∏ –∏ –∑–∞–≥—Ä—É–∑—á–∏–∫–∞:
```javascript
{/* –ì–∞–ª–µ—Ä–µ—è —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π */}
<PhotoGallery estimateId={savedEstimateId} />

{/* –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –∑–∞–≥—Ä—É–∑–∫–∏ */}
{showPhotoUploader && (
    <div className="fixed inset-0 z-50 flex items-center justify-center bg-black/50">
        <div className="bg-apple-bg-secondary rounded-2xl p-6 max-w-lg w-full">
            <PhotoUploader
                estimateId={savedEstimateId}
                onClose={() => setShowPhotoUploader(false)}
                onUploadComplete={() => {
                    setShowPhotoUploader(false);
                    // –û–±–Ω–æ–≤–∏—Ç—å –≥–∞–ª–µ—Ä–µ—é (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
                }}
            />
        </div>
    </div>
)}
```

---

## –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏

–ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –≤—Å–µ—Ö —à–∞–≥–æ–≤:

1. ‚úÖ –ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ: `npm run dev`
2. ‚úÖ –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Å–æ–ª—å –Ω–∞ –æ—à–∏–±–∫–∏
3. ‚úÖ –û—Ç–∫—Ä–æ–π—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –≤ –±—Ä–∞—É–∑–µ—Ä–µ
4. ‚úÖ –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É —Å–º–µ—Ç—ã
5. ‚úÖ –ù–∞–∂–º–∏—Ç–µ "–î–æ–±–∞–≤–∏—Ç—å —Ñ–æ—Ç–æ"
6. ‚úÖ –ó–∞–≥—Ä—É–∑–∏—Ç–µ —Ç–µ—Å—Ç–æ–≤–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ
7. ‚úÖ –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ —Ñ–æ—Ç–æ –ø–æ—è–≤–∏–ª–æ—Å—å –≤ –≥–∞–ª–µ—Ä–µ–µ

---

## –í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

### –û—à–∏–±–∫–∞ "PhotoProvider is not defined"
**–†–µ—à–µ–Ω–∏–µ**: –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –∏–º–ø–æ—Ä—Ç –¥–æ–±–∞–≤–ª–µ–Ω –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –≤ `layout.js`

### –û—à–∏–±–∫–∞ "relation project_photos does not exist" 
**–†–µ—à–µ–Ω–∏–µ**: –ú–∏–≥—Ä–∞—Ü–∏—è –ë–î –Ω–µ –±—ã–ª–∞ –ø—Ä–∏–º–µ–Ω–µ–Ω–∞. –ü–æ–≤—Ç–æ—Ä–∏—Ç–µ –®–∞–≥ 2

### –§–æ—Ç–æ –Ω–µ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è
**–†–µ—à–µ–Ω–∏–µ**: 
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ Supabase Storage bucket `project-photos` —Å–æ–∑–¥–∞–Ω
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ RLS –ø–æ–ª–∏—Ç–∏–∫–∏ –≤ Supabase Dashboard
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω

---

## –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### –î–æ–±–∞–≤–∏—Ç—å —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏ –≤ —ç–∫—Å–ø–æ—Ä—Ç PDF
–í –±—É–¥—É—â–µ–º –º–æ–∂–Ω–æ —Ä–∞—Å—à–∏—Ä–∏—Ç—å —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å —ç–∫—Å–ø–æ—Ä—Ç–∞ PDF, –≤–∫–ª—é—á–∏–≤ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∏–∑ –≥–∞–ª–µ—Ä–µ–∏:

```javascript
// –í —Ñ—É–Ω–∫—Ü–∏–∏ —ç–∫—Å–ø–æ—Ä—Ç–∞ PDF –¥–æ–±–∞–≤–∏—Ç—å —Ä–∞–∑–¥–µ–ª —Å —Ñ–æ—Ç–æ
const photos = await getPhotos(estimateId);
photos.forEach(photo => {
    doc.addImage(photoUrl, 'JPEG', x, y, width, height);
});
```

### –ö–∞—Å—Ç–æ–º–∏–∑–∞—Ü–∏—è —Å—Ç–∏–ª–µ–π
–í—Å–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç CSS –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∏–∑ `apple.css`, –ø–æ—ç—Ç–æ–º—É –ª–µ–≥–∫–æ –∞–¥–∞–ø—Ç–∏—Ä—É—é—Ç—Å—è –ø–æ–¥ –≤—ã–±—Ä–∞–Ω–Ω—É—é —Ç–µ–º—É.
